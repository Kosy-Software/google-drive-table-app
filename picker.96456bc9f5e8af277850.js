(()=>{"use strict";(()=>{const e=JSON.parse('{"l":{"c":"AIzaSyA0FVCn0xu3OFqynefuTwy5-Toatw-XLyg","x":"616819909997-uh4gnbl6pjhu4p8ic3vrgof49vejr5nn.apps.googleusercontent.com"}}');var t=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function c(e){try{s(n.next(e))}catch(e){r(e)}}function a(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(c,a)}s((n=n.apply(e,t||[])).next())}))};const o=new Date("1970-01-01T00:00:00Z").getTime();function n(n){return t(this,void 0,void 0,(function*(){let i=JSON.parse(localStorage.getItem("google_access_token")||"{}");return new Date(o+((null==i?void 0:i.expires_at)||0)-6e4)<new Date&&(i=yield function(o){return t(this,void 0,void 0,(function*(){return yield function(e){return t(this,void 0,void 0,(function*(){return new Promise(((t,o)=>gapi.load(e,{callback:()=>t({}),onerror:()=>o(),timeout:5e3,ontimeout:()=>o()})))}))}("auth2"),yield function(t,o){return gapi.auth2.init({client_id:e.l.x,scope:o}).then((()=>t(gapi.auth2.getAuthInstance())))}((e=>new Promise(((t,n)=>{try{let i=e.currentUser.get();i.hasGrantedScopes(o)?t(i.getAuthResponse(!0)):e.signIn().then((e=>t(e.getAuthResponse(!0)))).catch((e=>n(e)))}catch(e){n()}}))))}))}(n),localStorage.setItem("google_access_token",JSON.stringify(i))),i}))}var i,r=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function c(e){try{s(n.next(e))}catch(e){r(e)}}function a(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(c,a)}s((n=n.apply(e,t||[])).next())}))};!function(t){var o;(function(t){class o{start(){return r(this,void 0,void 0,(function*(){let t=yield n("https://www.googleapis.com/auth/drive.file").catch((()=>null));t||window.close(),(yield this.createPicker(t.access_token,e.l.c)).setVisible(!0)}))}createPicker(e,t){return r(this,void 0,void 0,(function*(){return yield new Promise(((e,t)=>{gapi.load("picker",{callback:()=>e({}),onerror:()=>t(),timeout:5e3,ontimeout:()=>t()})})),(new google.picker.PickerBuilder).addView(google.picker.ViewId.DOCS).setOAuthToken(e).setDeveloperKey(t).enableFeature(google.picker.Feature.NAV_HIDDEN).setOrigin(`${window.location.protocol}//${window.location.host}`).setCallback((e=>r(this,void 0,void 0,(function*(){if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){let t=e[google.picker.Response.DOCUMENTS][0],o={url:t[google.picker.Document.URL]};t.isShared||(o.error="NotShared"),this.sendMessage({type:"google-drive-validation-changed",payload:o}),window.close()}e[google.picker.Response.ACTION]==google.picker.Action.CANCEL&&window.close()})))).build()}))}sendMessage(e){window.opener.postMessage(e,window.location.origin)}}t.Picker=o,(new o).start()})((o=t.Integration||(t.Integration={})).GoogleDrive||(o.GoogleDrive={}))}(i||(i={}))})()})();