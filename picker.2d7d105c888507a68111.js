(()=>{"use strict";(()=>{const e="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.metadata.readonly",o=new Date("1970-01-01T00:00:00Z").getTime();async function t(){let t=JSON.parse(localStorage.getItem("google_access_token")||"{}");return new Date(o+((null==t?void 0:t.expires_at)||6e5)-6e4)<new Date&&(t=await async function(){return await async function(o){return await async function(e){return new Promise(((o,t)=>gapi.load(e,{callback:()=>o({}),onerror:()=>t(),timeout:5e3,ontimeout:()=>t()})))}("auth2"),gapi.auth2.init({client_id:"1055348097262-m31jmp68886tmq7hmsa7pgg0fopb9dot.apps.googleusercontent.com",scope:e}).then((()=>o(gapi.auth2.getAuthInstance())))}((o=>new Promise(((t,a)=>{try{let i=o.currentUser.get();i.hasGrantedScopes(e)?t(i.getAuthResponse(!0)):o.signIn().then((e=>t(e.getAuthResponse(!0)))).catch((e=>a(e)))}catch(e){a()}}))))}(),localStorage.setItem("google_access_token",JSON.stringify(t))),t}var a;!function(e){var o;(function(e){class o{async start(){let e=await t().catch((()=>null));e||window.close(),(await this.createPicker(e.access_token,"AIzaSyDFUoIEXWGk0NPtqPjCadqnEpcgxydw9ko")).setVisible(!0)}async createPicker(e,o){return await new Promise(((e,o)=>{gapi.load("picker",{callback:()=>e({}),onerror:()=>o(),timeout:5e3,ontimeout:()=>o()})})),(new google.picker.PickerBuilder).addView(google.picker.ViewId.DOCS).setOAuthToken(e).setDeveloperKey(o).enableFeature(google.picker.Feature.NAV_HIDDEN).setOrigin(`${window.location.protocol}//${window.location.host}`).setCallback((async e=>{if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){let o=e[google.picker.Response.DOCUMENTS][0],t=o[google.picker.Document.URL];this.sendMessage({type:"google-drive-url-picked",payload:{url:t,error:o.isShared?void 0:"NotShared"}}),window.close()}e[google.picker.Response.ACTION]==google.picker.Action.CANCEL&&window.close()})).build()}sendMessage(e){window.opener.postMessage(e,window.location.origin)}}e.Picker=o,(new o).start()})((o=e.Integration||(e.Integration={})).GoogleDrive||(o.GoogleDrive={}))}(a||(a={}))})()})();