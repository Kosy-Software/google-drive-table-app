(()=>{"use strict";(()=>{const e=JSON.parse('{"l":{"c":"AIzaSyA0FVCn0xu3OFqynefuTwy5-Toatw-XLyg","x":"616819909997-uh4gnbl6pjhu4p8ic3vrgof49vejr5nn.apps.googleusercontent.com"}}'),o="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.metadata.readonly",t=new Date("1970-01-01T00:00:00Z").getTime();async function n(){let n=JSON.parse(localStorage.getItem("google_access_token")||"{}");return new Date(t+((null==n?void 0:n.expires_at)||6e5)-6e4)<new Date&&(n=await async function(){return await async function(t){return await async function(e){return new Promise(((o,t)=>gapi.load(e,{callback:()=>o({}),onerror:()=>t(),timeout:5e3,ontimeout:()=>t()})))}("auth2"),gapi.auth2.init({client_id:e.l.x,scope:o}).then((()=>t(gapi.auth2.getAuthInstance())))}((e=>new Promise(((t,n)=>{try{let a=e.currentUser.get();a.hasGrantedScopes(o)?t(a.getAuthResponse(!0)):e.signIn().then((e=>t(e.getAuthResponse(!0)))).catch((e=>n(e)))}catch(e){n()}}))))}(),localStorage.setItem("google_access_token",JSON.stringify(n))),n}var a;!function(o){var t;(function(o){class t{async start(){let o=await n().catch((()=>null));o||window.close(),(await this.createPicker(o.access_token,e.l.c)).setVisible(!0)}async createPicker(e,o){return await new Promise(((e,o)=>{gapi.load("picker",{callback:()=>e({}),onerror:()=>o(),timeout:5e3,ontimeout:()=>o()})})),(new google.picker.PickerBuilder).addView(google.picker.ViewId.DOCS).setOAuthToken(e).setDeveloperKey(o).enableFeature(google.picker.Feature.NAV_HIDDEN).setOrigin(`${window.location.protocol}//${window.location.host}`).setCallback((async e=>{if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){let o=e[google.picker.Response.DOCUMENTS][0],t=o[google.picker.Document.URL];this.sendMessage({type:"google-drive-url-picked",payload:{url:t,error:o.isShared?void 0:"NotShared"}}),window.close()}e[google.picker.Response.ACTION]==google.picker.Action.CANCEL&&window.close()})).build()}sendMessage(e){window.opener.postMessage(e,window.location.origin)}}o.Picker=t,(new t).start()})((t=o.Integration||(o.Integration={})).GoogleDrive||(t.GoogleDrive={}))}(a||(a={}))})()})();