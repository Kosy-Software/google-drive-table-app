(()=>{"use strict";(()=>{const e=JSON.parse('{"l":{"c":"AIzaSyA0FVCn0xu3OFqynefuTwy5-Toatw-XLyg","x":"616819909997-uh4gnbl6pjhu4p8ic3vrgof49vejr5nn.apps.googleusercontent.com"}}');var o=function(e,o,t,n){return new(t||(t=Promise))((function(i,r){function c(e){try{s(n.next(e))}catch(e){r(e)}}function a(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,a)}s((n=n.apply(e,o||[])).next())}))};const t="https://www.googleapis.com/auth/drive.file",n=new Date("1970-01-01T00:00:00Z").getTime();var i,r=function(e,o,t,n){return new(t||(t=Promise))((function(i,r){function c(e){try{s(n.next(e))}catch(e){r(e)}}function a(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var o;e.done?i(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(c,a)}s((n=n.apply(e,o||[])).next())}))};!function(i){var c;(function(i){class c{start(){return r(this,void 0,void 0,(function*(){let i=yield function(){return o(this,void 0,void 0,(function*(){let i=JSON.parse(localStorage.getItem("google_access_token")||"{}");return new Date(n+((null==i?void 0:i.expires_at)||0)-6e4)<new Date&&(i=yield function(e){return o(this,void 0,void 0,(function*(){return yield function(e){return o(this,void 0,void 0,(function*(){return new Promise(((e,o)=>gapi.load("auth2",{callback:()=>e({}),onerror:()=>o(),timeout:5e3,ontimeout:()=>o()})))}))}(),yield new Promise(((o,n)=>{try{gapi.auth2.init({client_id:e,scope:t,fetch_basic_profile:!1});let r=gapi.auth2.getAuthInstance();var i=r.currentUser.get();i.hasGrantedScopes(t)?o(i.getAuthResponse(!0)):r.signIn().then((e=>o(e.getAuthResponse(!0)))).catch((e=>n(e)))}catch(e){n()}}))}))}(e.l.x),localStorage.setItem("google_access_token",JSON.stringify(i))),i}))}();i||window.close(),(yield this.createPicker(i.access_token,e.l.c)).setVisible(!0)}))}createPicker(e,o){return r(this,void 0,void 0,(function*(){return yield new Promise(((e,o)=>{gapi.load("picker",{callback:()=>e({}),onerror:()=>o(),timeout:5e3,ontimeout:()=>o()})})),(new google.picker.PickerBuilder).addView(google.picker.ViewId.DOCS).setOAuthToken(e).setDeveloperKey(o).enableFeature(google.picker.Feature.NAV_HIDDEN).setOrigin(`${window.location.protocol}//${window.location.host}`).setCallback((e=>r(this,void 0,void 0,(function*(){if(e[google.picker.Response.ACTION]==google.picker.Action.PICKED){let o=e[google.picker.Response.DOCUMENTS][0],t={url:o[google.picker.Document.URL]};o.isShared||(t.error="NotShared"),this.sendMessage({type:"google-drive-validation-changed",payload:t}),window.close()}e[google.picker.Response.ACTION]==google.picker.Action.CANCEL&&window.close()})))).build()}))}sendMessage(e){window.opener.postMessage(e,window.location.origin)}}i.Picker=c,(new c).start()})((c=i.Integration||(i.Integration={})).GoogleDrive||(c.GoogleDrive={}))}(i||(i={}))})()})();